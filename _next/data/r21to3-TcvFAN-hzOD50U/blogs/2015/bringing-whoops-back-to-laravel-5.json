{"pageProps":{"id":["posts","2015","bringing-whoops-back-to-laravel-5"],"post":{"id":["posts","2015","bringing-whoops-back-to-laravel-5"],"contentHtml":"<p>You might be missing the \"prettier\" Whoops error handler from Laravel 4. If so, here's how to bring it back.</p>\n<p>First, composer require filp/whoops:~1.0.</p>\n<p>Then open app/Exceptions/Handler.php, and in the render() method, add a Whoops handler in the else condition. Maybe something like this:</p>\n<div class=\"remark-highlight\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token doc-comment comment\">/**\n     * Render an exception into an HTTP response.\n     *\n     * <span class=\"token keyword\">@param</span>  <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Request</span>  <span class=\"token parameter\">$request</span>\n     * <span class=\"token keyword\">@param</span>  <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Exception</span>  <span class=\"token parameter\">$e</span>\n     * <span class=\"token keyword\">@return</span> <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Response</span>\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">render</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$request</span><span class=\"token punctuation\">,</span> <span class=\"token class-name type-declaration\">Exception</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token this keyword\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">isHttpException</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token this keyword\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">renderHttpException</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'app.debug'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token this keyword\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">renderExceptionWithWhoops</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token scope\"><span class=\"token keyword\">parent</span><span class=\"token punctuation\">::</span></span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$request</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token doc-comment comment\">/**\n     * Render an exception using Whoops.\n     * \n     * <span class=\"token keyword\">@param</span>  <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Exception</span> <span class=\"token parameter\">$e</span>\n     * <span class=\"token keyword\">@return</span> <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Response</span>\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">renderExceptionWithWhoops</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Exception</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$whoops</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name class-name-fully-qualified\"><span class=\"token punctuation\">\\</span>Whoops<span class=\"token punctuation\">\\</span>Run</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$whoops</span><span class=\"token operator\">-></span><span class=\"token function\">pushHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name class-name-fully-qualified\"><span class=\"token punctuation\">\\</span>Whoops<span class=\"token punctuation\">\\</span>Handler<span class=\"token punctuation\">\\</span>PrettyPageHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name class-name-fully-qualified\"><span class=\"token punctuation\">\\</span>Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Response</span><span class=\"token punctuation\">(</span>\n            <span class=\"token variable\">$whoops</span><span class=\"token operator\">-></span><span class=\"token function\">handleException</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token variable\">$e</span><span class=\"token operator\">-></span><span class=\"token function\">getStatusCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token variable\">$e</span><span class=\"token operator\">-></span><span class=\"token function\">getHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>That's it!</p>\n<p>Thanks to<a target=\"_blank\" target=\"_blank\" class=\"ext-link\" href=\"https://laracasts.com/discuss/channels/general-discussion/whoops-removed-from-laravel-5\">this thread</a>on the Laracasts forum for getting me moving in the right direction.</p>\n<p>参考地址：<a target=\"_blank\" target=\"_blank\" class=\"ext-link\" href=\"https://laracasts.com/discuss/channels/general-discussion/whoops-removed-from-laravel-5\">https://laracasts.com/discuss/channels/general-discussion/whoops-removed-from-laravel-5</a>\n原文地址：<a target=\"_blank\" target=\"_blank\" class=\"ext-link\" href=\"https://mattstauffer.co/blog/bringing-whoops-back-to-laravel-5\">https://mattstauffer.co/blog/bringing-whoops-back-to-laravel-5</a></p>\n","words":1267,"toc":[],"title":"Bringing Whoops Back to Laravel 5","author":"高国良","type":"posts","series":false,"date":"2015-03-12T09:06:00.791Z","tags":["laravel","php"],"description":"You might be missing the \"prettier\" Whoops error handler from Laravel 4. If so, here's how to bring it back.","draft":false,"cover":false},"prev":{"title":"在 Laravel 中使用图片处理库 Integration/Image","author":"高国良","type":"posts","series":false,"date":1418751600791,"tags":["php","laravel"],"description":"Integration/Image 是一个图片处理的库，其功能强大到���以处理你的几乎所有图片处理需求。本文介绍其在laravel框架下的安装与基本使用。","draft":false,"cover":false,"path":"/blogs/2014/use-the-integration-image-in-laravel","slug":"2014/use-the-integration-image-in-laravel"},"next":{"title":"CENTOS 6.5 平台离线安装 Apache2.4","author":"高国良","type":"posts","series":false,"date":1427378580791,"tags":["centos","apache","Linux"],"description":"下载、解压、处理依赖、编译、添加服务","draft":false,"cover":false,"path":"/blogs/2015/install-the-apache-2.4-on-centos-6.5","slug":"2015/install-the-apache-2.4-on-centos-6.5"}},"__N_SSG":true}